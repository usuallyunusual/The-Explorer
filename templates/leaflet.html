<!DOCTYPE html>
<html>

<head>
  <title>The Explorer - Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.2/dist/leaflet.css" />
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
    </script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='styles/final_map.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src='https://kit.fontawesome.com/a076d05399.js'></script>
  <link rel="icon" type="image/x-icon" href="{{url_for('static', filename = 'favicon.ico')}}">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet">
  <!--[if lte IE 8]><link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.2/dist/leaflet.ie.css" /><![endif]-->

  <!-- <link rel="stylesheet" href="../css/leaflet-sidebar.css" /> -->
  <style type="text/css">
    /*
    div.sticky {
      position: -webkit-sticky;
      position: sticky;
      top: 0;
    }
    */
    #snackbar {
      visibility: hidden;
      min-width: 250px;
      margin-left: -125px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 2px;
      padding: 16px;
      position: fixed;
      z-index: 1;
      left: 50%;
      bottom: 30px;
      font-size: 17px;
    }

    #snackbar.show {
      visibility: visible;
      -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
      animation: fadein 0.5s, fadeout 0.5s 2.5s;
    }

    @-webkit-keyframes fadein {
      from {
        bottom: 0;
        opacity: 0;
      }

      to {
        bottom: 30px;
        opacity: 1;
      }
    }

    @keyframes fadein {
      from {
        bottom: 0;
        opacity: 0;
      }

      to {
        bottom: 30px;
        opacity: 1;
      }
    }

    @-webkit-keyframes fadeout {
      from {
        bottom: 30px;
        opacity: 1;
      }

      to {
        bottom: 0;
        opacity: 0;
      }
    }

    @keyframes fadeout {
      from {
        bottom: 30px;
        opacity: 1;
      }

      to {
        bottom: 0;
        opacity: 0;
      }
    }

    .leaflet-sidebar {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
      overflow: hidden;
      z-index: 2000;
    }

    .leaflet-sidebar.collapsed {
      width: 40px;
    }

    @media (min-width: 768px) {
      .leaflet-sidebar {
        top: 10px;
        bottom: 10px;
        transition: width 500ms;
      }
    }

    @media (min-width: 768px) and (max-width: 991px) {
      .leaflet-sidebar {
        width: 305px;
        max-width: 305px;
      }
    }

    @media (min-width: 992px) and (max-width: 1199px) {
      .leaflet-sidebar {
        width: 390px;
        max-width: 390px;
      }
    }

    @media (min-width: 1200px) {
      .leaflet-sidebar {
        width: 460px;
        max-width: 460px;
      }
    }

    .leaflet-sidebar-left {
      left: 0;
    }

    @media (min-width: 768px) {
      .leaflet-sidebar-left {
        left: 10px;
      }
    }

    .leaflet-sidebar-right {
      right: 0;
    }

    @media (min-width: 768px) {
      .leaflet-sidebar-right {
        right: 10px;
      }
    }

    .leaflet-sidebar-tabs {
      top: 0;
      bottom: 0;
      height: 95%;
      background-color: #fff;
    }

    .leaflet-sidebar-left .leaflet-sidebar-tabs {
      left: 0;
    }

    .leaflet-sidebar-right .leaflet-sidebar-tabs {
      right: 0;
    }

    .leaflet-sidebar-tabs,
    .leaflet-sidebar-tabs>ul {
      position: absolute;
      width: 40px;
      margin: 0;
      padding: 0;
      list-style-type: none;
    }

    .leaflet-sidebar-tabs>li,
    .leaflet-sidebar-tabs>ul>li {
      width: 100%;
      height: 40px;
      color: #333;
      font-size: 12pt;
      overflow: hidden;
      transition: all 80ms;
    }

    .leaflet-sidebar-tabs>li:hover,
    .leaflet-sidebar-tabs>ul>li:hover {
      color: #000;
      background-color: #eee;
    }

    .leaflet-sidebar-tabs>li.active,
    .leaflet-sidebar-tabs>ul>li.active {
      color: black;
      background-color: #D5EAEC;
    }

    .leaflet-sidebar-tabs>li.disabled,
    .leaflet-sidebar-tabs>ul>li.disabled {
      color: rgba(51, 51, 51, 0.4);
    }

    .leaflet-sidebar-tabs>li.disabled:hover,
    .leaflet-sidebar-tabs>ul>li.disabled:hover {
      background: transparent;
    }

    .leaflet-sidebar-tabs>li.disabled>a,
    .leaflet-sidebar-tabs>ul>li.disabled>a {
      cursor: default;
    }

    .leaflet-sidebar-tabs>li>a,
    .leaflet-sidebar-tabs>ul>li>a {
      display: block;
      width: 100%;
      height: 100%;
      line-height: 40px;
      color: inherit;
      text-decoration: none;
      text-align: center;
      cursor: pointer;
    }

    .leaflet-sidebar-tabs>ul+ul {
      bottom: 0;
    }

    .leaflet-sidebar-content {
      position: absolute;
      top: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.95);
      overflow-x: hidden;
      overflow-y: auto;
    }

    .leaflet-sidebar-left .leaflet-sidebar-content {
      left: 40px;
      right: 0;
      height: 95%;
    }

    .leaflet-sidebar-right .leaflet-sidebar-content {
      left: 0;
      right: 40px;
    }

    .leaflet-sidebar.collapsed>.leaflet-sidebar-content {
      overflow-y: hidden;
    }

    .collapsed>.leaflet-sidebar-content {
      overflow-y: hidden;
    }

    .leaflet-sidebar-pane {
      display: none;
      left: 0;
      right: 0;
      box-sizing: border-box;
      padding: 10px 20px;
    }

    .leaflet-sidebar-pane.active {
      display: block;
    }

    @media (min-width: 768px) and (max-width: 991px) {
      .leaflet-sidebar-pane {
        min-width: 265px;
      }
    }

    @media (min-width: 992px) and (max-width: 1199px) {
      .leaflet-sidebar-pane {
        min-width: 350px;
      }
    }

    @media (min-width: 1200px) {
      .leaflet-sidebar-pane {
        min-width: 420px;
      }
    }

    .leaflet-sidebar-header {
      margin: -10px -20px 0;
      height: 40px;
      padding: 0 20px;
      line-height: 40px;
      font-size: 14.4pt;
      color: black;
      background-color: #D5EAEC;
      font-family: 'Sarabun', sans-serif;
    }

    .leaflet-sidebar-right .leaflet-sidebar-header {
      padding-left: 40px;
    }

    .leaflet-sidebar-close {
      position: absolute;
      top: 0;
      width: 40px;
      height: 40px;
      text-align: center;
      cursor: pointer;
    }

    .leaflet-sidebar-left .leaflet-sidebar-close {
      right: 0;
    }

    .leaflet-sidebar-right .leaflet-sidebar-close {
      left: 0;
    }

    /*.leaflet-sidebar {
      }*/
    @media (min-width: 768px) {
      .leaflet-sidebar {
        border-radius: 4px;
      }

      .leaflet-sidebar.leaflet-touch {
        border: 2px solid rgba(0, 0, 0, 0.2);
      }
    }

    .leaflet-sidebar-left.leaflet-touch {
      box-shadow: none;
      border-right: 2px solid rgba(0, 0, 0, 0.2);
    }

    @media (min-width: 768px) {
      .leaflet-sidebar-left~.leaflet-control-container .leaflet-left {
        transition: left 500ms;
      }
    }

    @media (min-width: 768px) and (max-width: 991px) {
      .leaflet-sidebar-left~.leaflet-control-container .leaflet-left {
        left: 315px;
      }
    }

    @media (min-width: 992px) and (max-width: 1199px) {
      .leaflet-sidebar-left~.leaflet-control-container .leaflet-left {
        left: 400px;
      }
    }

    @media (min-width: 1200px) {
      .leaflet-sidebar-left~.leaflet-control-container .leaflet-left {
        left: 470px;
      }
    }

    .leaflet-sidebar-left.collapsed~.leaflet-control-container .leaflet-left {
      left: 50px;
    }

    .leaflet-sidebar-right.leaflet-touch {
      box-shadow: none;
      border-left: 2px solid rgba(0, 0, 0, 0.2);
    }

    @media (min-width: 768px) {
      .leaflet-sidebar-right~.leaflet-control-container .leaflet-right {
        transition: right 500ms;
      }
    }

    @media (min-width: 768px) and (max-width: 991px) {
      .leaflet-sidebar-right~.leaflet-control-container .leaflet-right {
        right: 315px;
      }
    }

    @media (min-width: 992px) and (max-width: 1199px) {
      .leaflet-sidebar-right~.leaflet-control-container .leaflet-right {
        right: 400px;
      }
    }

    @media (min-width: 1200px) {
      .leaflet-sidebar-right~.leaflet-control-container .leaflet-right {
        right: 470px;
      }
    }

    .leaflet-sidebar-right.collapsed~.leaflet-control-container .leaflet-right {
      right: 50px;
    }
  </style>


  <style>
    body {
      padding: 0;
      margin: 0;
    }

    html,
    body,
    #map {
      height: 95%;
      font: 15px;
      font-family: 'Sarabun', sans-serif;
    }

    .timelineup {
      font-family: 'Sarabun', sans-serif;
      display: flex;
      font: 15px;
    }

    .timelinedown {
      font-family: 'Sarabun', sans-serif;
      font: 15px;
    }

    p,
    h1,
    h2,
    h3,
    h4,
    h5 {
      font-family: 'Sarabun', sans-serif;
      color: black;
      text-align: justify;
    }

    .flag_maintext {
      font-family: 'Sarabun', sans-serif;
      font-size: 25px;
      font-weight: bold;
      text-align: center;
    }

    .flag_subtext {
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
      font-weight: bold;
      text-align: center;
    }

    .event_name {
      font-weight: bold;
      font-size: 25px;
      text-align: center;
      font-family: 'Sarabun', sans-serif;
    }

    .flag {
      text-align: left;
      float: left;
    }

    .event_year {
      font-size: 15px;
      text-align: right;
      font-family: 'Sarabun', sans-serif;
    }

    .event_text {
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
      line-height: 1.5;

    }

    .search_title {
      font-weight: bold;
      font-size: 20px;
      text-align: left;
      font-family: 'Sarabun', sans-serif;
      text-decoration: underline;
      cursor: pointer;
    }

    .search_desc {
      font-family: 'Sarabun', sans-serif;
      font-size: 13px;
      margin-top: 20px;
    }

    .search_button

    /* search button*/
      {
      border-radius: 20px;
      border: 0.1px solid #000000;
      background-color: #D5EAEC;
      color: #000000;
      font-size: 15px;
      font-weight: bold;
      padding: 10px 10px;
      letter-spacing: 1px;
      text-transform: uppercase;
      transition: transform 80ms ease-in;
      text-align: center;
      display: inline;
      margin: 0.5em 0em 1em 0.4em;
    }

    .search_button:active {
      transform: scale(0.95);
    }

    .search_button:focus {
      outline: none;
    }

    .search_button:hover {
      background-color: #dddddd;
      border-color: black;
      color: black;
    }


    .genre_button

    /* button*/
      {
      border-radius: 20px;
      border: 0.1px solid #000000;
      background-color: #D5EAEC;
      color: #000000;
      font-size: 15px;
      font-weight: bold;
      padding: 10px 25px;
      letter-spacing: 1px;
      text-transform: uppercase;
      transition: transform 80ms ease-in;
      text-align: center;
    }

    .genre_button:active {
      transform: scale(0.95);
    }

    .genre_button:focus {
      outline: none;
    }

    .genre_button:hover {
      background-color: #dddddd;
      border-color: black;
      color: black;
    }

    .genres

    /*for input*/
      {
      font-family: 'Sarabun', sans-serif;
      font-size: 10px;
      color: black;
      padding: 10px;
      margin: 10px;
      height: 20px;
      width: 20px;
    }

    label {
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
      color: black;
    }

    p {
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
      color: black;
    }

    .logout-text {
      font-family: 'Sarabun', sans-serif;
      font-size: 20px;
      color: black;
    }

    span {
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
      color: black;
      font-weight: normal;
    }

    .prof {
      background-color: #FFFFFF;
      border: 0.5px solid black;
      padding: 10px 10px;
      margin: 20px;
      width: 250px;
      height: 20px;
      font-size: 15px;
    }

    .year

    /* year buttons */
      {
      border: 0.5px solid #dddddd;
      background-color: #ffffff;
      color: #000000;
      font-size: 16px;
      font-weight: bold;
      padding: 9px;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      text-align: center;
      float: left;
      font-family: 'Sarabun', sans-serif;
      height: 35px;
    }

    .year-active {
      background-color: #D5EAEC;
      color: black;
      border: 0.5px solid #dddddd;
      border-color: black;
      font-size: 15px;
      font-weight: bold;
      padding: 7px;
      letter-spacing: 1.2px;
      text-transform: uppercase;
      text-align: center;
      float: left;
      font-family: 'Sarabun', sans-serif;
      height: 35px;
    }

    .year:focus {
      outline: none;
      background-color: #D5EAEC;
      border-color: black;
      color: black;
    }

    .year:hover {
      background-color: #D5EAEC;
      border-color: black;
      color: black;
    }

    .bottom-year

    /* 100 year buttons */
      {
      border: 0.5px solid #dddddd;
      background-color: #ffffff;
      color: #000000;
      font-size: 13px;
      font-weight: bold;
      /*padding: 3px;*/
      letter-spacing: 1.1px;
      text-transform: uppercase;
      text-align: center;
      /*float: left;*/
      font-family: 'Sarabun', sans-serif;
      height: 40px;
      width: 70px;
      display: inline-block;
      margin-right: -3.8px;
    }

    .bottom-year-active {
      background-color: #D5EAEC;
      color: black;
      border: 0.5px solid #dddddd;
      border-color: black;
      font-size: 13px;
      font-weight: bold;
      letter-spacing: 1.1px;
      text-transform: uppercase;
      text-align: center;
      font-family: 'Sarabun', sans-serif;
      height: 40px;
      width: 70px;
      display: inline-block;
      margin-right: -3.8px;
    }

    .bottom-year:focus {
      outline: none;
      background-color: #D5EAEC;
      color: black;
      border-color: black;
    }

    .bottom-year:hover {
      background-color: #D5EAEC;
      border-color: black;
      color: black;
    }

    div .scroll {
      width: 100%;
      height: 70px;
      overflow-x: scroll;
      overflow-y: hidden;
      white-space: nowrap;
    }

    .s_input {
      -webkit-border-radius: 20px;
      -moz-border-radius: 20px;
      border-radius: 20px;
      border: 1px solid #000000;
      color: #000000;
      width: 250px;
      height: 35px;
      padding-left: 10px;
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
      float: left;
      margin: 0.5em 0em 1em 0.4em;

    }

    .s_input:focus {
      outline: none;
      border: 2px solid black;
      color: black;
      font-family: 'Sarabun', sans-serif;
      font-size: 15px;
    }
  </style>
</head>

<body>
  <!-- optionally define the sidebar content via HTML markup -->
  <div id="sidebar" class="leaflet-sidebar collapsed">

    <!-- nav tabs -->
    <div class="leaflet-sidebar-tabs">
      <!-- top aligned tabs -->
      <ul role="tablist">
        <li id="searchtab"><a href="#search" role="tab"><i class="fa fa-search"></i></a></li>
        <li><a href="#home" role="tab"><i class="fa fa-bars active"></i></a></li>
        <li><a href="#profile" role="tab"><i class="fa fa-user"></i></a></li>
        <li><a href="#contact" role="tab"><i class="fa fa-envelope"></i></a></li>
        <li><a href="#logout" role="tab"><i class="fas fa-user-lock"></i></a></li>
      </ul>
    </div>
    <!-- SEARCH STARTS HERE-->
    <div id="snackbar">Explorer! You flagged an article</div>

    <div class="leaflet-sidebar-content">
      <div class="leaflet-sidebar-pane" id="search">
        <h1 class="leaflet-sidebar-header">
          Search
          <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
        </h1>
        <div>
          <input class="s_input" type="text" id="tags" onkeypress="search_event(event)" placeholder="Search">
          <button class="search_button" type="submit" onclick="search_event(event)">Search</button>
          <br><br>
        </div>
        <!-- For search result -->
        <div id="results">
        </div>
      </div>
      <script>
        function snack() {
          var x = document.getElementById("snackbar");
          x.className = "show";
          setTimeout(function () { x.className = x.className.replace("show", ""); }, 3000);
        }
        function flagArticle() {
          var article_data = window.flagdata;
          rightsidebar.setContent("<p class='flag_maintext'>Explorer! You have flagged an article.</p><p class='flag_subtext'>Answer these questions to help us understand what was wrong with the article.</p><input type='radio' id='r1' name='flag' value='The Year is Wrong' checked='checked'><label for='r1' class='flag_subtext'>The Year is wrong</label><br><br><input type='radio'id='r2'" +
            " name='flag' value='The Genre is wrong''><label for='r2' class='flag_subtext'>The Genre is wrong</label><br><br>" +
            "<input type='radio' id='r3' name='flag' value='The Location is wrong'> <label for='r3' class='flag_subtext'>The Location is wrong</label><br<br><br><br>" +
            "<textarea style='resize:none;' id='flagtext' rows='10'cols='50' placeholder='(Optional) Tell us more about what was wrong.'></textarea>" +
            "<br><br><button class = 'genre_button'  id='fl'>Submit</button></div>");
          $("#fl").click(function () {
            var radioflag = document.querySelector('input[name="flag"]:checked').value;
            var txt = $("#flagtext").val();
            var today = new Date().toISOString().slice(0, 10);
            var now = new Date().toLocaleString('en-GB').slice(12);
            $.ajax({
              url: "{{ url_for('send_flag') }}",
              type: 'GET',
              datatype: 'json',
              data: { 'event_key': article_data.event_key, 'radioflag': radioflag, 'flagDesc': txt, 'date': today, 'time': now },
              success: function (data) {
                console.log(data);
                if (data) {
                  data = window.flagdata;
                  rightsidebar.setContent("<h1  class='event_name'><img onclick=" + "\'flagArticle()\'" +
                    "  class='flag' src='{{url_for('static', filename='flag_article.svg')}}' height='40' width='40'>" + data.event_name + "</h1><p   class='event_year'>" + data.year +
                    "</p><p class='event_text'>" + data.description + "</p><p> To know more visit-</p><a target = '_blank' href = '" +
                    data.url + "'>" + data.url + "</a>");
                  rightsidebar.show();
                  snack();
                }
              }
            });
          });
        }
        function show_article(id) {
          $.ajax({
            url: "{{ url_for('_get_data') }}",
            type: 'GET',
            datatype: 'json',
            data: { 'id': id },
            success: function (data) {
              if (data) {
                searchmarker = window.searchMarkerTemp;
                for (var i = 0; i < searchmarker.length; i++) {
                  if (id == searchmarker[i][0]) {
                    //console.log(searchmarker[i][0], searchmarker[i][1], searchmarker[i][2]);
                    map.setView([parseInt(searchmarker[i][1]), parseInt(searchmarker[i][2])], 6);

                  }
                }
                window.flagdata = data;
                rightsidebar.setContent("<h1  class='event_name'><img onclick=" + "\'flagArticle()\'" +
                  "  class='flag' src='{{url_for('static', filename='flag_article.svg')}}' height='40' width='40'>" + data.event_name + "</h1><p   class='event_year'>" + data.year +
                  "</p><p class='event_text'>" + data.description + "</p><p> To know more visit-</p><a target = '_blank' href = '" +
                  data.url + "'>" + data.url + "</a>");
                rightsidebar.show();
              }
            }
          });
        }
        function search_event(key) {
          if ($("#tags").val() === "") {
            return;
          }
          if (key.srcElement.id === "tags") {
            if (key.which === 13) {
              var html = "<div class='text-center' style = {width:100%;height = 100%}>";
              html += "<img src='static/infinity.gif'></div>";
              $("#results").html(html);
              $.ajax({
                url: "/search",
                type: 'GET',
                datatype: 'json',
                data: { "query": $("#tags").val() },
                success: function (response) {
                  response = response["res"];
                  var toins = "";
                  var keys = new Object();
                  for (i = 0; i < 6; i++) {
                    //console.log(response[i]);
                    toins += "<div><p onclick='show_article(" + response[i][0] + ")' id = '" + response[i][0] + "'class='search_title'>" + response[i][1] + "</p><p class='search_desc'>" + response[i][2].slice(0, 100) + "...</p></div>";
                    keys[String(i)] = String(response[i][0]);
                  }
                  $("#results").html(toins);
                  get_year(keys, 1);

                }
              });
            }
          }
          else {
            var html = "<div class='text-center' style = {width:100%;height = 100%}>";
            html += "<img src='static/infinity.gif'></div>";
            $("#results").html(html);
            $.ajax({
              url: "/search",
              type: 'GET',
              datatype: 'json',
              data: { "query": $("#tags").val() },
              success: function (response) {
                response = response["res"];
                var toins = "";
                var keys = new Object();
                for (i = 0; i < 6; i++) {
                  toins += "<div><p id = '" + response[i][0] + "'class='search_title' onclick='show_article(" + response[i][0] + ")'>" + response[i][1] + "</p><p class='search_desc'>" + response[i][2].slice(0, 100) + "...</p></div>";
                  keys[String(i)] = String(response[i][0]);
                }
                $("#results").html(toins);
                get_year(keys, 1);
              }
            });
          }
        };
      </script>

      <div class="leaflet-sidebar-pane" id="home">
        <h1 class="leaflet-sidebar-header">
          Select Genres
          <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
        </h1>

        <p> Select One or more genres and click the button. See the changes on the map.
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Education')"><label>
            Education</label></input>
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Biology')"><label>
            Biology</label></input>
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Computer Science')"><label> Computer
            Science</label></input>
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Health')"><label>
            Health</label></input>
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Political')"><label>
            Political</label></input>
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Art')"><label> Art</label></input>
          <br>
          <input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Religious')"><label>
            Religious</label></input>
          <br><input class="genres" type="checkbox" id="myCheck" onclick="myFunction('Sports')"><label>
            Sports</label></input>
          <br>
          <script>
            function myFunction(genre) {
              $.ajax({
                url: "{{ url_for('_set_genre') }}",
                type: 'GET',
                data: { 'genre': genre },
                success: function (data) {
                  $(".bottom-year-active").click();
                }
              });
            }
          </script>

        </p>
      </div>

      <div class="leaflet-sidebar-pane" id="profile">
        <h1 class="leaflet-sidebar-header">
          Profile
          <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
        </h1>
        <p>
        <form>
          <label for="name">Name</label>
          <input class="prof" type="text" placeholder="Name" id="name" readonly value="Blah Blah" /><br>
          <label for="email">E-Mail</label>
          <input class="prof" type="email" placeholder="Email" id="email" value="Blah Blah" readonly />
        </form>
        </p>
      </div>

      <div class="leaflet-sidebar-pane" id="contact">
        <h1 class="leaflet-sidebar-header">
          Contact Us
          <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
        </h1>
        <p>
          <br>
          <span><i class="fa fa-envelope"></i>&emsp;the.explorer.verify@gmail.com</span><br><br>
          <span><i class="fa fa-phone"></i>&emsp;8989898989</span><br><br>
          <span><i class="fa fa-map"></i>&emsp;Christ University, Bangalore</span>
        </p>
      </div>

      <div class="leaflet-sidebar-pane" id="logout">
        <h1 class="leaflet-sidebar-header">
          Logout

          <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
        </h1>
        <p class="logout-text">
          We are sorry to see you go! Come back soon Explorer!
        </p>
        <br>
        <form id="log" style="display:none" action="{{ url_for('logout') }}" method="GET"></form>
        <center><button class="genre_button" type="submit" onclick="$('#log').submit();">Logout</button></center>
      </div>
    </div>
  </div>

  <div id="sidebar-right">
    <p id="event_name" class="event_name">Welcome to The Expl<img src="{{url_for('static', filename='earth.png')}}"
        height="25" width="25">rer</p>
    <p id="event_text" class="event_text">
      1. Click on the map markers to get detailed information about the events. Hover over the markers to see the event
      names.<br><br>
      2. Select an year from the timeline and see the events associated with that year on the map.<br><br>
      3. Click the flag icon to flag an article in case of any mistakes.<br><br>
      4. Use the right navigation bar to :
    <ul>
      <li>Search a keyword or event.</li>
      <li>Select genres and classify the map events accordingly.</li>
      <li>View the details you used to registered with The Explorer.</li>
      <li>Contact Us</li>
      <li>Logout</li>
    </ul>
    </p>
  </div>

  <div id="map"></div>

  <div class="timelineup btn-group" id="centuries">
    <button class="year" onclick="update_band(-500,this)" style="margin-left: 2px;">500BC</button>
    <button class="year" onclick="update_band(-400,this)">400BC</button>
    <button class="year" onclick="update_band(-300,this)">300BC</button>
    <button class="year" onclick="update_band(-200,this)">200BC</button>
    <button class="year" onclick="update_band(-100,this)">100BC</button>
    <button class="year" onclick="update_band(0,this)" style="width: 50px;">0</button>
    <button class="year" onclick="update_band(100,this)">100</button>
    <button class="year" onclick="update_band(200,this)">200</button>
    <button class="year" onclick="update_band(300,this)">300</button>
    <button class="year" onclick="update_band(400,this)">400</button>
    <button class="year" onclick="update_band(500,this)">500</button>
    <button class="year" onclick="update_band(600,this)">600</button>
    <button class="year" onclick="update_band(700,this)">700</button>
    <button class="year" onclick="update_band(800,this)">800</button>
    <button class="year" onclick="update_band(900,this)">900</button>
    <button class="year" onclick="update_band(1000,this)">1000</button>
    <button class="year" onclick="update_band(1100,this)">1100</button>
    <button class="year" onclick="update_band(1200,this)">1200</button>
    <button class="year" onclick="update_band(1300,this)">1300</button>
    <button class="year" onclick="update_band(1400,this)">1400</button>
    <button class="year" onclick="update_band(1500,this)">1500</button>
    <button class="year" onclick="update_band(1600,this)">1600</button>
    <button class="year" onclick="update_band(1700,this)">1700</button>
    <button class="year" onclick="update_band(1800,this)">1800</button>
    <button class="year" onclick="update_band(1900,this)">1900</button>
    <button class="year" onclick="update_band(2000,this)">2000</button>
  </div>

  <div class="timelinedown btn-group">
    <div class="scroll">
      <button class="bottom-year">1901</button>
      <button class="bottom-year">1902</button>
      <button class="bottom-year">1903</button>
      <button class="bottom-year">1904</button>
      <button class="bottom-year">1905</button>
      <button class="bottom-year">1906</button>
      <button class="bottom-year">1907</button>
      <button class="bottom-year">1908</button>
      <button class="bottom-year">1909</button>
      <button class="bottom-year">1910</button>
      <button class="bottom-year">1911</button>
      <button class="bottom-year">1912</button>
      <button class="bottom-year">1913</button>
      <button class="bottom-year">1914</button>
      <button class="bottom-year">1915</button>
      <button class="bottom-year">1916</button>
      <button class="bottom-year">1917</button>
      <button class="bottom-year">1918</button>
      <button class="bottom-year">1919</button>
      <button class="bottom-year">1920</button>
      <button class="bottom-year">1921</button>
      <button class="bottom-year">1922</button>
      <button class="bottom-year">1923</button>
      <button class="bottom-year">1924</button>
      <button class="bottom-year">1925</button>
      <button class="bottom-year">1901</button>
      <button class="bottom-year">1902</button>
      <button class="bottom-year">1903</button>
      <button class="bottom-year">1904</button>
      <button class="bottom-year">1905</button>
      <button class="bottom-year">1906</button>
      <button class="bottom-year">1907</button>
      <button class="bottom-year">1908</button>
      <button class="bottom-year">1909</button>
      <button class="bottom-year">1910</button>
      <button class="bottom-year">1911</button>
      <button class="bottom-year">1912</button>
      <button class="bottom-year">1913</button>
      <button class="bottom-year">1914</button>
      <button class="bottom-year">1915</button>
      <button class="bottom-year">1916</button>
      <button class="bottom-year">1917</button>
      <button class="bottom-year">1918</button>
      <button class="bottom-year">1919</button>
      <button class="bottom-year">1920</button>
      <button class="bottom-year">1921</button>
      <button class="bottom-year">1922</button>
      <button class="bottom-year">1923</button>
      <button class="bottom-year">1924</button>
      <button class="bottom-year">1925</button>
      <button class="bottom-year">1901</button>
      <button class="bottom-year">1902</button>
      <button class="bottom-year">1903</button>
      <button class="bottom-year">1904</button>
      <button class="bottom-year">1905</button>
      <button class="bottom-year">1906</button>
      <button class="bottom-year">1907</button>
      <button class="bottom-year">1908</button>
      <button class="bottom-year">1909</button>
      <button class="bottom-year">1910</button>
      <button class="bottom-year">1911</button>
      <button class="bottom-year">1912</button>
      <button class="bottom-year">1913</button>
      <button class="bottom-year">1914</button>
      <button class="bottom-year">1915</button>
      <button class="bottom-year">1916</button>
      <button class="bottom-year">1917</button>
      <button class="bottom-year">1918</button>
      <button class="bottom-year">1919</button>
      <button class="bottom-year">1920</button>
      <button class="bottom-year">1921</button>
      <button class="bottom-year">1922</button>
      <button class="bottom-year">1923</button>
      <button class="bottom-year">1924</button>
      <button class="bottom-year">1925</button>
      <button class="bottom-year">1901</button>
      <button class="bottom-year">1902</button>
      <button class="bottom-year">1903</button>
      <button class="bottom-year">1904</button>
      <button class="bottom-year">1905</button>
      <button class="bottom-year">1906</button>
      <button class="bottom-year">1907</button>
      <button class="bottom-year">1908</button>
      <button class="bottom-year">1909</button>
      <button class="bottom-year">1910</button>
      <button class="bottom-year">1911</button>
      <button class="bottom-year">1912</button>
      <button class="bottom-year">1913</button>
      <button class="bottom-year">1914</button>
      <button class="bottom-year">1915</button>
      <button class="bottom-year">1916</button>
      <button class="bottom-year">1917</button>
      <button class="bottom-year">1918</button>
      <button class="bottom-year">1919</button>
      <button class="bottom-year">1920</button>
      <button class="bottom-year">1921</button>
      <button class="bottom-year">1922</button>
      <button class="bottom-year">1923</button>
      <button class="bottom-year">1924</button>
      <button class="bottom-year">1925</button>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@0.7.2/dist/leaflet.js"></script>
  <script>


    // @ts-nocheck
    /**
     * @name Sidebar
     * @class L.Control.Sidebar
     * @extends L.Control
     * @param {string} id - The id of the sidebar element (without the # character)
     * @param {Object} [options] - Optional options object
     * @param {string} [options.autopan=false] - whether to move the map when opening the sidebar to make maintain the visible center point
     * @param {string} [options.position=left] - Position of the sidebar: 'left' or 'right'
     * @param {string} [options.id] - ID of a predefined sidebar container that should be used
     * @param {boolean} [data.close=true] Whether to add a close button to the pane header
     * @see L.control.sidebar
     */
    L.Control.Sidebar = L.Control.extend(/** @lends L.Control.Sidebar.prototype */
      {
        includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,

        options:
        {
          autopan: false,
          closeButton: true,
          container: null,
          position: 'left'
        },

        /**
         * Create a new sidebar on this object.
         *
         * @constructor
         * @param {Object} [options] - Optional options object
         * @param {string} [options.autopan=false] - whether to move the map when opening the sidebar to make maintain the visible center point
         * @param {string} [options.position=left] - Position of the sidebar: 'left' or 'right'
         * @param {string} [options.container] - ID of a predefined sidebar container that should be used
         * @param {bool} [data.close=true] Whether to add a close button to the pane header
         */
        initialize: function (options, deprecatedOptions) {
          if (typeof options === 'string') {
            console.warn('this syntax is deprecated. please use L.control.sidebar({ container }) now');
            options = { container: options };
          }

          if (typeof options === 'object' && options.id) {
            console.warn('this syntax is deprecated. please use L.control.sidebar({ container }) now');
            options.container = options.id;
          }

          this._tabitems = [];
          this._panes = [];
          this._closeButtons = [];

          L.setOptions(this, options);
          L.setOptions(this, deprecatedOptions);
          return this;
        },

        /**
         * Add this sidebar to the specified map.
         *
         * @param {L.Map} map
         * @returns {Sidebar}
         */
        onAdd: function (map) {
          var i, child, tabContainers, newContainer, container;

          // use container from previous onAdd()
          container = this._container

          // use the container given via options.
          if (!container) {
            container = this._container || typeof this.options.container === 'string'
              ? L.DomUtil.get(this.options.container)
              : this.options.container;
          }

          // if no container was specified or not found, create it and apply an ID
          if (!container) {
            container = L.DomUtil.create('div', 'leaflet-sidebar collapsed');
            if (typeof this.options.container === 'string')
              container.id = this.options.container;
          }

          // Find paneContainer in DOM & store reference
          this._paneContainer = container.querySelector('div.leaflet-sidebar-content');

          // If none is found, create it
          if (this._paneContainer === null)
            this._paneContainer = L.DomUtil.create('div', 'leaflet-sidebar-content', container);

          // Find tabContainerTop & tabContainerBottom in DOM & store reference
          tabContainers = container.querySelectorAll('ul.leaflet-sidebar-tabs, div.leaflet-sidebar-tabs > ul');
          this._tabContainerTop = tabContainers[0] || null;
          this._tabContainerBottom = tabContainers[1] || null;

          // If no container was found, create it
          if (this._tabContainerTop === null) {
            newContainer = L.DomUtil.create('div', 'leaflet-sidebar-tabs', container);
            newContainer.setAttribute('role', 'tablist');
            this._tabContainerTop = L.DomUtil.create('ul', '', newContainer);
          }
          if (this._tabContainerBottom === null) {
            newContainer = this._tabContainerTop.parentNode;
            this._tabContainerBottom = L.DomUtil.create('ul', '', newContainer);
          }

          // Store Tabs in Collection for easier iteration
          for (i = 0; i < this._tabContainerTop.children.length; i++) {
            child = this._tabContainerTop.children[i];
            child._sidebar = this;
            child._id = child.querySelector('a').hash.slice(1); // FIXME: this could break for links!
            this._tabitems.push(child);
          }
          for (i = 0; i < this._tabContainerBottom.children.length; i++) {
            child = this._tabContainerBottom.children[i];
            child._sidebar = this;
            child._id = child.querySelector('a').hash.slice(1); // FIXME: this could break for links!
            this._tabitems.push(child);
          }

          // Store Panes in Collection for easier iteration
          for (i = 0; i < this._paneContainer.children.length; i++) {
            child = this._paneContainer.children[i];
            if (child.tagName === 'DIV' &&
              L.DomUtil.hasClass(child, 'leaflet-sidebar-pane')) {
              this._panes.push(child);

              // Save references to close buttons
              var closeButtons = child.querySelectorAll('.leaflet-sidebar-close');
              if (closeButtons.length) {
                this._closeButtons.push(closeButtons[closeButtons.length - 1]);
                this._closeClick(closeButtons[closeButtons.length - 1], 'on');
              }
            }
          }

          // set click listeners for tab & close buttons
          for (i = 0; i < this._tabitems.length; i++) {
            this._tabClick(this._tabitems[i], 'on');
          }

          // leaflet moves the returned container to the right place in the DOM
          return container;
        },

        /**
         * Remove this sidebar from the map.
         *
         * @param {L.Map} map
         * @returns {Sidebar}
         */
        onRemove: function (map) {
          // Remove click listeners for tab & close buttons
          for (var i = 0; i < this._tabitems.length; i++)
            this._tabClick(this._tabitems[i], 'off');
          for (var i = 0; i < this._closeButtons.length; i++)
            this._closeClick(this._closeButtons[i], 'off');

          this._tabitems = [];
          this._panes = [];
          this._closeButtons = [];

          return this;
        },

        /**
         * @method addTo(map: Map): this
         * Adds the control to the given map. Overrides the implementation of L.Control,
         * changing the DOM mount target from map._controlContainer.topleft to map._container
         */
        addTo: function (map) {
          this.onRemove();
          this._map = map;

          this._container = this.onAdd(map);

          L.DomUtil.addClass(this._container, 'leaflet-control');
          L.DomUtil.addClass(this._container, 'leaflet-sidebar-' + this.getPosition());
          if (L.Browser.touch)
            L.DomUtil.addClass(this._container, 'leaflet-touch');

          // when adding to the map container, we should stop event propagation
          L.DomEvent.disableScrollPropagation(this._container);
          L.DomEvent.disableClickPropagation(this._container);
          L.DomEvent.on(this._container, 'contextmenu', L.DomEvent.stopPropagation);

          // insert as first child of map container (important for css)
          map._container.insertBefore(this._container, map._container.firstChild);

          return this;
        },

        /**
         * @deprecated - Please use remove() instead of removeFrom(), as of Leaflet 0.8-dev, the removeFrom() has been replaced with remove()
         * Removes this sidebar from the map.
         * @param {L.Map} map
         * @returns {Sidebar}
         */
        removeFrom: function (map) {
          console.warn('removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon.');
          this._map._container.removeChild(this._container);
          this.onRemove(map);

          return this;
        },

        /**
          * Open sidebar (if it's closed) and show the specified tab.
          *
          * @param {string} id - The ID of the tab to show (without the # character)
          * @returns {L.Control.Sidebar}
          */
        open: function (id) {
          var i, child, tab;

          // If panel is disabled, stop right here
          tab = this._getTab(id);
          if (L.DomUtil.hasClass(tab, 'disabled'))
            return this;

          // Hide old active contents and show new content
          for (i = 0; i < this._panes.length; i++) {
            child = this._panes[i];
            if (child.id === id)
              L.DomUtil.addClass(child, 'active');
            else if (L.DomUtil.hasClass(child, 'active'))
              L.DomUtil.removeClass(child, 'active');
          }

          // Remove old active highlights and set new highlight
          for (i = 0; i < this._tabitems.length; i++) {
            child = this._tabitems[i];
            if (child.querySelector('a').hash === '#' + id)
              L.DomUtil.addClass(child, 'active');
            else if (L.DomUtil.hasClass(child, 'active'))
              L.DomUtil.removeClass(child, 'active');
          }

          this.fire('content', { id: id });

          // Open sidebar if it's closed
          if (L.DomUtil.hasClass(this._container, 'collapsed')) {
            this.fire('opening');
            L.DomUtil.removeClass(this._container, 'collapsed');
            if (this.options.autopan) this._panMap('open');
          }

          return this;
        },

        /**
         * Close the sidebar (if it's open).
         *
         * @returns {L.Control.Sidebar}
         */
        close: function () {
          var i;

          // Remove old active highlights
          for (i = 0; i < this._tabitems.length; i++) {
            var child = this._tabitems[i];
            if (L.DomUtil.hasClass(child, 'active'))
              L.DomUtil.removeClass(child, 'active');
          }

          // close sidebar, if it's opened
          if (!L.DomUtil.hasClass(this._container, 'collapsed')) {
            this.fire('closing');
            L.DomUtil.addClass(this._container, 'collapsed');
            if (this.options.autopan) this._panMap('close');
          }

          return this;
        },

        /**
         * Add a panel to the sidebar
         *
         * @example
         * sidebar.addPanel({
         *     id: 'userinfo',
         *     tab: '<i class="fa fa-gear"></i>',
         *     pane: someDomNode.innerHTML,
         *     position: 'bottom'
         * });
         *
         * @param {Object} [data] contains the data for the new Panel:
         * @param {String} [data.id] the ID for the new Panel, must be unique for the whole page
         * @param {String} [data.position='top'] where the tab will appear:
         *                                       on the top or the bottom of the sidebar. 'top' or 'bottom'
         * @param {HTMLString} {DOMnode} [data.tab]  content of the tab item, as HTMLstring or DOM node
         * @param {HTMLString} {DOMnode} [data.pane] content of the panel, as HTMLstring or DOM node
         * @param {String} [data.link] URL to an (external) link that will be opened instead of a panel
         * @param {String} [data.title] Title for the pane header
         * @param {String} {Function} [data.button] URL to an (external) link or a click listener function that will be opened instead of a panel
         * @param {bool} [data.disabled] If the tab should be disabled by default
         *
         * @returns {L.Control.Sidebar}
         */
        addPanel: function (data) {
          var pane, tab, tabHref, closeButtons, content;

          // Create tab node
          tab = L.DomUtil.create('li', data.disabled ? 'disabled' : '');
          tabHref = L.DomUtil.create('a', '', tab);
          tabHref.href = '#' + data.id;
          tabHref.setAttribute('role', 'tab');
          tabHref.innerHTML = data.tab;
          tab._sidebar = this;
          tab._id = data.id;
          tab._button = data.button; // to allow links to be disabled, the href cannot be used
          if (data.title && data.title[0] !== '<') tab.title = data.title;

          // append it to the DOM and store JS references
          if (data.position === 'bottom')
            this._tabContainerBottom.appendChild(tab);
          else
            this._tabContainerTop.appendChild(tab);

          this._tabitems.push(tab);

          // Create pane node
          if (data.pane) {
            if (typeof data.pane === 'string') {
              // pane is given as HTML string
              pane = L.DomUtil.create('DIV', 'leaflet-sidebar-pane', this._paneContainer);
              content = '';
              if (data.title)
                content += '<h1 class="leaflet-sidebar-header">' + data.title;
              if (this.options.closeButton)
                content += '<span class="leaflet-sidebar-close"><i class="fa fa-caret-' + this.options.position + '"></i></span>';
              if (data.title)
                content += '</h1>';
              pane.innerHTML = content + data.pane;
            }
            else {
              // pane is given as DOM object
              pane = data.pane;
              this._paneContainer.appendChild(pane);
            }
            pane.id = data.id;

            this._panes.push(pane);

            // Save references to close button & register click listener
            closeButtons = pane.querySelectorAll('.leaflet-sidebar-close');
            if (closeButtons.length) {
              // select last button, because thats rendered on top
              this._closeButtons.push(closeButtons[closeButtons.length - 1]);
              this._closeClick(closeButtons[closeButtons.length - 1], 'on');
            }
          }

          // Register click listeners, if the sidebar is on the map
          this._tabClick(tab, 'on');

          return this;
        },

        /**
         * Removes a panel from the sidebar
         *
         * @example
         * sidebar.remove('userinfo');
         *
         * @param {String} [id] the ID of the panel that is to be removed
         * @returns {L.Control.Sidebar}
         */
        removePanel: function (id) {
          var i, j, tab, pane, closeButtons;

          // find the tab & panel by ID, remove them, and clean up
          for (i = 0; i < this._tabitems.length; i++) {
            if (this._tabitems[i]._id === id) {
              tab = this._tabitems[i];

              // Remove click listeners
              this._tabClick(tab, 'off');

              tab.remove();
              this._tabitems.splice(i, 1);
              break;
            }
          }

          for (i = 0; i < this._panes.length; i++) {
            if (this._panes[i].id === id) {
              pane = this._panes[i];
              closeButtons = pane.querySelectorAll('.leaflet-sidebar-close');
              for (j = 0; j < closeButtons.length; j++) {
                this._closeClick(closeButtons[j], 'off');
              }

              pane.remove();
              this._panes.splice(i, 1);

              break;
            }
          }

          return this;
        },

        /**
         * enables a disabled tab/panel
         *
         * @param {String} [id] ID of the panel to enable
         * @returns {L.Control.Sidebar}
         */
        enablePanel: function (id) {
          var tab = this._getTab(id);
          L.DomUtil.removeClass(tab, 'disabled');

          return this;
        },

        /**
         * disables an enabled tab/panel
         *
         * @param {String} [id] ID of the panel to disable
         * @returns {L.Control.Sidebar}
         */
        disablePanel: function (id) {
          var tab = this._getTab(id);
          L.DomUtil.addClass(tab, 'disabled');

          return this;
        },

        onTabClick: function (e) {
          // `this` points to the tab DOM element!
          if (L.DomUtil.hasClass(this, 'active')) {
            $("#tags").val("");
            $("#results").html("");
            this._sidebar.close();
          }
          else if (!L.DomUtil.hasClass(this, 'disabled')) {
            if (typeof this._button === 'string') // an url
              window.location.href = this._button;
            else if (typeof this._button === 'function') // a clickhandler
              this._button(e);
            else // a normal pane
              this._sidebar.open(this.querySelector('a').hash.slice(1));
          }
        },

        /**
         * (un)registers the onclick event for the given tab,
         * depending on the second argument.
         * @private
         *
         * @param {DOMelement} [tab]
         * @param {String} [on] 'on' or 'off'
         */
        _tabClick: function (tab, on) {
          var link = tab.querySelector('a');
          if (!link.hasAttribute('href') || link.getAttribute('href')[0] !== '#')
            return;

          if (on === 'on') {
            L.DomEvent
              .on(tab.querySelector('a'), 'click', L.DomEvent.preventDefault, tab)
              .on(tab.querySelector('a'), 'click', this.onTabClick, tab);
          }
          else {
            L.DomEvent.off(tab.querySelector('a'), 'click', this.onTabClick, tab);
          }
        },

        onCloseClick: function () {
          this.close();
          $("#tags").val("");
          $("#results").html("");
        },

        /**
         * (un)registers the onclick event for the given close button
         * depending on the second argument
         * @private
         *
         * @param {DOMelement} [closeButton]
         * @param {String} [on] 'on' or 'off'
         */
        _closeClick: function (closeButton, on) {
          if (on === 'on') {
            L.DomEvent.on(closeButton, 'click', this.onCloseClick, this);
          }
          else {
            L.DomEvent.off(closeButton, 'click', this.onCloseClick);
          }
        },

        /**
         * Finds & returns the DOMelement of a tab
         *
         * @param {String} [id] the id of the tab
         * @returns {DOMelement} the tab specified by id, null if not found
         */
        _getTab: function (id) {
          for (var i = 0; i < this._tabitems.length; i++) {
            if (this._tabitems[i]._id === id)
              return this._tabitems[i];
          }

          throw Error('tab "' + id + '" not found');
        },

        /**
         * Helper for autopan: Pans the map for open/close events
         *
         * @param {String} [openClose] The behaviour to enact ('open' | 'close')
         */
        _panMap: function (openClose) {
          var panWidth = Number.parseInt(L.DomUtil.getStyle(this._container, 'max-width')) / 2;
          if (
            openClose === 'open' && this.options.position === 'left' ||
            openClose === 'close' && this.options.position === 'right'
          ) panWidth *= -1;
          this._map.panBy([panWidth, 0], { duration: 0.5 });
        }
      });


    L.control.sidebar = function (options, deprecated) {
      return new L.Control.Sidebar(options, deprecated);
    };


    // standard leaflet map setup
    var map = L.map('map',
      {
        center: [51.505, -0.09],
        minZoom: 3,
        zoom: 3,
        maxZoom: 18
      });



    //esri.world_street_map
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',
      {
        attribution: 'Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012'
      }).addTo(map);


    // create the sidebar instance and add it to the map
    var sidebar = L.control.sidebar({ container: 'sidebar' })
      .addTo(map)
      .open('home');

    // add panels dynamically to the sidebar
    sidebar.close();


    // be notified when a panel is opened
    sidebar.on('content', function (ev) {
      switch (ev.id) {
        case 'autopan':
          sidebar.options.autopan = true;
          break;
        default:
          sidebar.options.autopan = false;
      }
    });



    var userid = 0
    function addUser() {
      sidebar.addPanel({
        id: 'user' + userid++,
        tab: '<i class="fa fa-user"></i>',
        title: 'User Profile ' + userid,
        pane: '<p>user ipsum dolor sit amet</p>',
      });
    }
  </script>
  <script src="{{url_for('static', filename='final_map.js')}}"></script>
  <script>
    var southWest = L.latLng(-89.98155760646617, -180),
      northEast = L.latLng(89.99346179538875, 180);
    var bounds = L.latLngBounds(southWest, northEast);

    map.setMaxBounds(bounds);
    map.on('drag', function () {
      map.panInsideBounds(bounds, { animate: false });
    });

    window.rightsidebar = L.control.sidebar('sidebar-right',
      {
        closeButton: true,
        position: 'right',
        autoPan: false
      });
    map.addControl(rightsidebar);
    //map.removeControl(map.zoomControl);
    setTimeout(function () {
      rightsidebar.show();
    }, 500);

    var redIcon = new L.Icon({
      iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
      shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });


    var mark = JSON.parse('{{ marker_data | tojson | safe}}');
    var user = JSON.parse('{{ user | tojson | safe}}');
    $("#name").attr("value", user[0].name);
    $("#email").attr("value", user[0].email);
    var i = 0;
    markers = [];
    for (i = 0; i < mark.length; i++) {
      markers[i] = new L.marker([mark[i].lat, mark[i].long], { icon: redIcon }).addTo(map).on('click', function (event) {
        map.setView([event.latlng.lat, event.latlng.lng], 6);
        $.ajax({
          url: "{{ url_for('_get_data') }}",
          type: 'GET',
          data: { 'id': event.target.id },
          success: function (data) {
            if (data) {
              rightsidebar.setContent("<h1  class='event_name'>" + data.event_name + "</h1><p   class='event_year'>" + data.year + "</p><p class='event_text'>" + data.description + "</p><a target = '_blank' href = '" + data.url + "'>" + data.url + "</a>");
              rightsidebar.show();
              event.target.openPopup();

            }
          }
        });
      });
      markers[i].id = mark[i].id;
      markers[i].bindPopup(mark[i].popline);
      markers[i].on('mouseover', function (event) {
        event.target.openPopup();
        setTimeout(function () {
          event.target.closePopup();
        }, 1000);
      });
    }
    //window.markers = markers;
    window.cities = L.layerGroup(markers);
    window.cities.addTo(map);
    L.DomEvent.on(rightsidebar.getCloseButton(), 'click', function () {
    });
    function handleError(data) {
      console.log(data);
    };
    function get_year(key, list_option) {
      //console.log(key);
      var selected_year = new Object();
      selected_year.option = list_option;
      var data;
      if (list_option === 0) {
        selected_year.data = parseInt($(key).text());
        data = { "main": JSON.stringify(selected_year) }
      }
      else {
        selected_year.data = key;
        data = { "main": JSON.stringify(selected_year) }
      }
      $.ajax({
        url: "{{ url_for('_get_year_data') }}",
        type: 'GET',
        datatype: 'json',
        data: data,
        success: function (data) {
          if (data) {
            map.removeLayer(window.cities);
            map.setView([51.505, -0.09], 3);
            window.rightsidebar.hide();
            if (data === "Fail") {
              handleError(data);
              return;
            }
            var searchArray = new Array();
            var mark = data;
            var i = 0;
            markers = [];
            for (i = 0; i < mark.length; i++) {
              searchArray[i] = new Array(mark[i].id, mark[i].lat, mark[i].long);
              //console.log(mark[i].id);
              markers[i] = new L.marker([mark[i].lat, mark[i].long], { icon: redIcon }).addTo(map).on('click', function (event) {
                map.setView([event.latlng.lat, event.latlng.lng], 6);
                show_article(event.target.id);

              });
              markers[i].id = mark[i].id;
              markers[i].bindPopup(mark[i].popline);
              markers[i].on('mouseover', function (event) {
                event.target.openPopup();
                setTimeout(function () {
                  event.target.closePopup();
                }, 1000);
              });
            }
            window.cities = L.layerGroup(markers);
            window.cities.addTo(map);

          }
          window.searchMarkerTemp = searchArray;
          //console.log(window.searchMarkerTemp);
        },
        error: handleError
      });

    }
    function switchmenu(ele) {
      var y = document.getElementsByClassName("bottom-year-active");
      if (y.length !== 0) {
        for (i = 0; i < y.length; i++) {
          y[i].className = "bottom-year";
        }
      }
      ele.className = "bottom-year-active"
    }

    function update_band(selected_century, ele) {
      if (ele !== null) {
        var y = document.getElementsByClassName("year-active");
        if (y.length !== 0) {
          for (i = 0; i < y.length; i++) {
            y[i].className = "year";
          }
        }
        ele.className = "year-active"
      }
      else {
        var y = document.getElementsByClassName("year");
        for (i = 0; i < y.length; i++) {
          if (y[i].innerHTML == selected_century) {
            y[i].className = "year-active";
          }
        }
      }
      var y = document.getElementsByClassName("bottom-year-active");
      if (y.length !== 0) {
        for (i = 0; i < y.length; i++) {
          y[i].className = "bottom-year";
        }
      }
      var x = document.getElementsByClassName("bottom-year");
      for (i = 0; i < 100; i++) {
        x[i].innerHTML = selected_century++;
        x[i].setAttribute('onclick', 'switchmenu(this); get_year(this,0);');
      }

    }
    $(document).ready(function () { update_band(1900, null) });
  </script>
</body>

</html>